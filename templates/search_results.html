{% extends 'base.html' %}
{% block content %}

    

<!-- Create a div for every Trail using a Jinja for loop -->
<div class='trail-div'>

    <div class="container-fluid">
            <table class="table table-hover">
                <tr>
                    <th>Trail Name</th>
                    <th>Plan Hike</th> 
                    <th>Trail URL</th>
                    <th>Location</th>
                    <th>Trail Summary</th>
                    <th>Trail Image</th>
                </tr>


    {% for i in range(number) %}
    <tr>
        <td>{{ num_results[i].get('name') }}  &nbsp;  
            {% if num_results[i].get('name') in visited_names  %}
                <h4>You have already visited this trail<h4>
            {% endif %}</td>

        <td><span class="hikeit-span">
            <button id="hike-it" data-tooltip="{{ num_results[i].get('id') }}" data-name="{{ num_results[i].get('name') }}" data-url="{{ num_results[i].get('url') }}" data-length="{{ num_results[i].get('length') }}" data-type="{{ num_results[i].get('type') }}" data-stars="{{ num_results[i].get('stars') }}">Hike It</button>
            Enter Date: <input type="date" name="date" id="date-time">
        </span></td>
        
        <td><a href= "">{{ num_results[i].get('url') }}</td>
        <td>{{ num_results[i].get('location') }} </td>
        <td>{{ num_results[i].get('summary') }} </td>
       <td><img src="{{ num_results[i].get('imgSqSmall') }}" ></td>

    </tr>
    {% endfor %}

    </table>
</div>

 </div>  

 <head>
    <title>Geocoding service</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 500px;
        width: 800px;
      }

    </style>
  </head>
  <body>

    <div id="map"></div>
    <script>
      function initMap() {
        
        var myLatLng = {lat: {{lat}}, lng: {{lng}} };

        var map = new google.maps.Map(document.getElementById('map'), {
          zoom: 8,
          center: myLatLng
        });

        bounds  = new google.maps.LatLngBounds();

        {% for i in range(number) %}

        var i = new google.maps.LatLng({{ num_results[i].get('latitude') }}, {{ num_results[i].get('longitude') }});
        bounds.extend(i);
        var marker = new google.maps.Marker({
        position: i,
        map: map,
        title: '{{ num_results[i].get('name') }}'
        
        });

        {% endfor %}

        map.fitBounds(bounds);
        map.panToBounds(bounds);

      }


    </script>
    <script
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBeD1vIu0C2hIMeiLWDD0_4L28Mj8A4YyM&callback=initMap">
    </script>


  </body>


<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
<script>
  "use strict";

  function showInfo(results){
    console.log(results.trail_id)
    
  }

  function getInfo(evt){
    evt.preventDefault();

    let datevalue = $(this).next().val()
    
    var formInputs = {
        "trail_id": $(this).data('tooltip'),
        "date": datevalue,
        "name": $(this).data('name'),
        "url" : $(this).data('url'),
        "length": $(this).data('length'),
        "type" : $(this).data('type'),
        "stars": $(this).data('stars')
    };

    
    $.post("/get-trails-info",formInputs, showInfo);
  }

  $("#hike-it ").on('click', getInfo);


</script>


{% endblock %}
